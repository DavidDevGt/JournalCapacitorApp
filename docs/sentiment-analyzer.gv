digraph SentimentAnalysisFlow {
    rankdir=TB;
    node [shape=box, style=filled, color="#e0e0e0", fontname="Arial"];

    InputText [label="ðŸ“ Input Text", fillcolor="#ffccff"];
    CheckCache [label="ðŸ§  Â¿En Cache?", shape=diamond, fillcolor="#ffffcc"];
    ReturnCached [label="ðŸ” Return Cached Result", fillcolor="#ccffcc"];
    Preprocess [label="ðŸ§¼ Preprocess Text\n(lowercase, clean)", fillcolor="#ffffff"];
    Tokenize [label="âœ‚ï¸ Tokenize Words"];
    CheckMinWords [label="ðŸ” Â¿Min. Words >= Threshold?", shape=diamond];
    ReturnDefault [label="âšª Return Default Result", fillcolor="#ffcccc"];
    ScoreHeuristic [label="ðŸ§® Heuristic Scoring\n(SentimentWords, Negaciones, Intensificadores)"];
    ScoreBayes [label="ðŸ“Š Bayes Prediction\n(Naive Bayes)"];
    DetectEmotions [label="â¤ï¸ Detect Emotions\n(keyword matching)"];
    CombineScores [label="âš–ï¸ Combine Scores\n(0.7 Heuristic + 0.3 Bayes)"];
    CalculateConfidence [label="ðŸ“ Calculate Confidence"];
    MapEmoji [label="ðŸ˜Š Map Score to Emoji"];
    BuildResult [label="ðŸ§± Build Final Result"];
    SaveCache [label="ðŸ’¾ Save in Cache"];
    ReturnResult [label="ðŸ“¤ Return Final Result", fillcolor="#ccccff"];

    // Connections
    InputText -> CheckCache;
    CheckCache -> ReturnCached [label="âœ… SÃ­"];
    CheckCache -> Preprocess [label="âŒ No"];
    Preprocess -> Tokenize;
    Tokenize -> CheckMinWords;
    CheckMinWords -> ReturnDefault [label="âŒ No"];
    CheckMinWords -> ScoreHeuristic [label="âœ… SÃ­"];
    ScoreHeuristic -> ScoreBayes;
    ScoreBayes -> DetectEmotions;
    DetectEmotions -> CombineScores;
    CombineScores -> CalculateConfidence;
    CalculateConfidence -> MapEmoji;
    MapEmoji -> BuildResult;
    BuildResult -> SaveCache;
    SaveCache -> ReturnResult;
}
